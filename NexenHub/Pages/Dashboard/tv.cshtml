@page
@model NexenHub.Pages.Dashboard.tvModel
@{
    Layout = null;

    string stl = Model.ICSCount == Model.LatestCount ? "alert-primary" : "alert-warning";

    string stlRex = Model.RexCount == Model.LatestCountRex ? "alert-primary" : "alert-warning";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="refresh" content="30">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css" />
</head>

<body class="" style="background-color:#000000;">
    <div class="container-fluid">


        @{
            if (!@Model.isPM && @Model.allPingOK)
            {
                <!--Space filler-->
                <div class="w-100" style="height:20vh;"></div>
            }
        }

        @{
            if (!@Model.isPM)
            {
                <div class="alert alert-primary text-center mt-2" role="alert">
                    <h2 class="alert-heading">No PM is in progress</h2>
                </div>
            }
            else
            {
                <div class="alert alert-warning text-center mt-2" role="alert">
                    <h2 class="alert-heading">PM in progress</h2>
                </div>

                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 row-cols-xl-5 g-2">
                    @foreach (var dev in @Model.MachinesPM)
                    {

                        <div class="col">
                            <div class="card h-100 bg-warning text-dark">
                                <div class="card-header text-center">
                                    <h2> @dev.Name</h2>
                                </div>
                                <div class="card-body text-center">
                                    <h3>@dev.Start.ToString("HH:mm")</h3>
                                </div>
                            </div>
                        </div>

                    }
                </div>
            }
        }

        @{
            if (!Model.allPingOK)
            {
                <div class="alert alert-danger text-center mt-2" role="alert">
                    <h2 class="alert-heading">Unreachable devices</h2>
                </div>

                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 row-cols-xl-5 g-2">
                    @foreach (var dev in @Model.FailPing)
                    {

                        <div class="col">
                            <div class="card h-100 bg-danger text-light">
                                <div class="card-header text-center">
                                    <h2> @dev.Name </h2>
                                </div>
                                <div class="card-body text-center">
                                    <h3>@dev.IP</h3>
                                </div>
                            </div>
                        </div>

                    }
                </div>

            }
            else
            {
                <div class="alert alert-primary text-center mt-2" role="alert">
                    <h2 class="alert-heading">All NMP / ICS (@Model.PingDevices.Count) are online</h2>
                </div>
            }

        }


        <div class="alert @stl text-center mt-2" role="alert">
            <h2 class="alert-heading">ICS Latest version: @Model.LatestICSVersion.ToString("yy-MM-dd") | Installed on @Model.LatestCount / @Model.ICSCount</h2>
        </div>

        <div class="alert @stlRex text-center mt-2" role="alert">
            <h2 class="alert-heading">Rex Latest version: @Model.LatestRexVersion.ToString("yy-MM-dd") | Installed on @Model.LatestCountRex / @Model.RexCount</h2>
        </div>

    </div>
</body>
</html>